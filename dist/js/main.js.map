{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["(function() {\n    'use strict';\n    var app = require('app');\n    var BrowserWindow = require('browser-window');\n\n    // report crashes\n    require('crash-reporter').start();\n\n    // keep global reference of the window object\n    var mainWindow = null;\n\n    // quit when all windows are closed\n    app.on('window-all-closed', function() {\n        if (process.platform != 'darwin') {\n            app.quit();\n        }\n    });\n\n    app.on('ready', function() {\n        mainWindow = new BrowserWindow({width: 1000, height: 800});\n\n        // load index.html\n        mainWindow.loadUrl('file://' + __dirname + '/../index.html');\n\n        mainWindow.on('closed', function() {\n            mainWindow = null;\n        });\n    });\n\n    var ipc = require('ipc');\n\n    function getUserHome() {\n        return process.env[(process.platform == 'win32') ? 'USERPROFILE' : 'HOME'];\n    }\n\n    ipc.on('download-invoice', function (event, data) {\n        var target = getUserHome() + '/',\n            fs = require('fs'),\n            request = require('request'),\n            file, suffixNumber = 1;\n\n        function checkFile (fileName) {\n            fs.exists(fileName, function (exists) {\n                var tmp;\n                if (exists) {\n                    tmp = target.replace(/\\.pdf$/, ' (' + suffixNumber + ').pdf');\n                    suffixNumber++;\n                    checkFile(tmp);\n                } else {\n                    file = fs.createWriteStream(fileName);\n\n                    request(data.url).pipe(file);\n                }\n            });\n        }\n\n\n        fs.exists(target + 'Downloads', function (exists) {\n            if (exists) {\n                target += 'Downloads/';\n            }\n\n            target += data.fileName;\n\n            checkFile(target);\n        });\n\n    });\n}());\n"],"file":"main.js","sourceRoot":"/source/"}